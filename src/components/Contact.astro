---
const engagementModels = [
  'Project & program consulting',
  'Strategic advisory',
  'Interim leadership placement',
  'Board advisory services',
];
---

<section id="contact" class="py-20 px-6 bg-charcoal">
  <div class="max-w-6xl mx-auto">
    <div class="grid lg:grid-cols-2 gap-12">
      <!-- Left Column: Form -->
      <div>
        <h2 class="text-3xl font-light text-cream mb-4">Let's Connect</h2>
        <p id="contact-subtitle" class="text-stone mb-8 max-w-md">
          Available for strategic advisory, transformation leadership, and interim executive engagements.
        </p>

        <div id="form-container">
          <form id="contact-form" class="space-y-4">
          <div class="grid md:grid-cols-2 gap-4">
            <div>
              <label for="firstname" class="block text-sm text-stone mb-1">First Name</label>
              <input
                type="text"
                id="firstname"
                name="firstname"
                class="w-full bg-gray-800 border border-gray-700 rounded px-4 py-3 text-cream placeholder-gray-500 focus:outline-none focus:border-deep-sage transition-colors"
              />
            </div>
            <div>
              <label for="lastname" class="block text-sm text-stone mb-1">Last Name</label>
              <input
                type="text"
                id="lastname"
                name="lastname"
                class="w-full bg-gray-800 border border-gray-700 rounded px-4 py-3 text-cream placeholder-gray-500 focus:outline-none focus:border-deep-sage transition-colors"
              />
            </div>
          </div>

          <div>
            <label for="email" class="block text-sm text-stone mb-1">
              Email <span class="text-deep-sage">*</span>
            </label>
            <input
              type="email"
              id="email"
              name="email"
              required
              class="w-full bg-gray-800 border border-gray-700 rounded px-4 py-3 text-cream placeholder-gray-500 focus:outline-none focus:border-deep-sage transition-colors"
            />
          </div>

          <div class="grid md:grid-cols-2 gap-4">
            <div>
              <label for="phone" class="block text-sm text-stone mb-1">Phone</label>
              <input
                type="tel"
                id="phone"
                name="phone"
                class="w-full bg-gray-800 border border-gray-700 rounded px-4 py-3 text-cream placeholder-gray-500 focus:outline-none focus:border-deep-sage transition-colors"
              />
            </div>
            <div>
              <label for="company" class="block text-sm text-stone mb-1">Company</label>
              <input
                type="text"
                id="company"
                name="company"
                class="w-full bg-gray-800 border border-gray-700 rounded px-4 py-3 text-cream placeholder-gray-500 focus:outline-none focus:border-deep-sage transition-colors"
              />
            </div>
          </div>

          <div>
            <label for="message" class="block text-sm text-stone mb-1">How can we help?</label>
            <textarea
              id="message"
              name="how_can_we_help_"
              rows="4"
              class="w-full bg-gray-800 border border-gray-700 rounded px-4 py-3 text-cream placeholder-gray-500 focus:outline-none focus:border-deep-sage transition-colors resize-none"
            ></textarea>
          </div>

          <button
            type="submit"
            class="w-full bg-cream text-charcoal font-medium py-3 rounded hover:bg-deep-sage hover:text-cream transition-colors"
          >
            Send Message
          </button>

          <!-- Error Message -->
          <div id="form-error" class="hidden text-center py-4 text-red-400">
            Something went wrong. Please try again.
          </div>
        </form>
        </div>
      </div>

      <!-- Right Column: Contact Info -->
      <div class="lg:pl-12">
        <div class="mb-12">
          <h3 class="text-sm font-medium text-taupe uppercase tracking-wide mb-4">Direct Contact</h3>
          <div class="space-y-3">
            <a href="mailto:info@changemanaged.io" class="flex items-center gap-3 text-stone hover:text-muted-sage transition-colors">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
              </svg>
              info@changemanaged.io
            </a>
            <a href="https://www.linkedin.com/company/change-managed-io/" target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 text-stone hover:text-muted-sage transition-colors">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
              </svg>
              Connect on LinkedIn
            </a>
          </div>
        </div>

        <div>
          <h3 class="text-sm font-medium text-taupe uppercase tracking-wide mb-4">Engagement Models</h3>
          <ul class="space-y-2">
            {engagementModels.map((model) => (
              <li class="flex items-center gap-2 text-stone">
                <span class="w-1.5 h-1.5 bg-deep-sage rounded-full"></span>
                {model}
              </li>
            ))}
          </ul>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="mt-16 pt-8 border-t border-gray-800 text-sm text-stone flex flex-wrap items-center justify-between gap-4">
      <p>© 2025 Change Managed LLC • Philadelphia, PA • Veteran-Owned Small Business</p>
      <svg
        class="w-5 h-5 text-muted-sage"
        viewBox="0 0 32 32"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M16 4L28 28H4L16 4Z"
          stroke="currentColor"
          stroke-width="1.5"
          stroke-linejoin="miter"
          stroke-linecap="square"
          fill="none"
        />
      </svg>
    </div>
  </div>
</section>

<script is:inline>
  console.log('Contact script loaded!');

  var PORTAL_ID = '244508325';
  var FORM_GUID = '38080cd1-4438-430c-9a17-f20d05c2924c';

  var form = document.getElementById('contact-form');
  var formContainer = document.getElementById('form-container');
  var subtitle = document.getElementById('contact-subtitle');
  var errorEl = document.getElementById('form-error');

  console.log('Form found:', !!form);

  if (form) {
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      console.log('Form submitted!');

      var formData = new FormData(form);
      var fields = [];

      formData.forEach(function(value, key) {
        if (value) {
          fields.push({ name: key, value: value.toString() });
        }
      });

      fetch(
        'https://api.hsforms.com/submissions/v3/integration/submit/' + PORTAL_ID + '/' + FORM_GUID,
        {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ fields: fields }),
        }
      )
      .then(function(response) {
        console.log('Response:', response.status);
        if (response.ok) {
          if (formContainer) {
            formContainer.innerHTML = '<div class="text-center py-8"><div class="flex flex-col items-center gap-4"><div style="width:64px;height:64px;background:#2D5F4F;border-radius:50%;display:flex;align-items:center;justify-content:center;"><svg style="width:32px;height:32px;color:#FAFAF8;" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div><p style="color:#FAFAF8;font-size:1.25rem;">Thanks, we\'ll be in touch within one business day.</p></div></div>';
          }
          if (subtitle) subtitle.style.display = 'none';
        } else {
          throw new Error('Form submission failed');
        }
      })
      .catch(function(error) {
        console.log('Error:', error);
        if (errorEl) errorEl.style.display = 'block';
      });
    });
  }
</script>
